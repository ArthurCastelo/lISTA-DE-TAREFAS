import random

def tarefaPendente(sistema):
    for e in sistema:
        for v in e.values():
            if(v == 'sim'):
                imprimir(e)


def imprimir(e):
    for k, v in e.items():
        print(k+"- {}".format(v))
    print("\n")


def pesquisaDia(sistema, dia):
    for e in sistema:
        for v in e.values():
            if(v == dia):
                imprimir(e)


def editarDia(sistema, ID, novoDia):
    for e in sistema:
        for v in e.values():
            if(v == ID):
                e['dia'] = novoDia


def editarPendencia(sistema, ID, pendencia):
    for e in sistema:
        for v in e.values():
            if(v == ID):
                e['pendente'] = pendencia


def editarTarefa(sistema, ID):
    # Encontrar a tarefa
    alterarTarefa = next


def tarefaPendente(sistema):
    for e in sistema:
        for v in e.values():
            if(v == 'sim'):
                imprimir(e)


def imprimir(e):
    for k, v in e.items():
        print(k+"- {}".format(v))
    print("\n")


def pesquisaDia(sistema, dia):
    for e in sistema:
        for v in e.values():
            if(v == dia):
                imprimir(e)


def editarDia(sistema, ID, novoDia):
    for e in sistema:
        for v in e.values():
            if(v == ID):
                e['dia'] = novoDia


def editarPendencia(sistema, ID, pendencia):
    for e in sistema:
        for v in e.values():
            if(v == ID):
                e['pendente'] = pendencia

def horarioEDiaJaUtilizado(dia, hora):
    horarioJaUtilizado = next(
        (tarefa for tarefa in sistema if tarefa["hora"] == hora and tarefa["dia"] == dia), False)
    
    if horarioJaUtilizado:
        return True
    else:
        return False

def editarTarefa(sistema, idTarefa):
    # Encontrar a tarefa
    alterarTarefa = next(
        (tarefa for tarefa in sistema if tarefa["ID"] == idTarefa), False)

    if (not alterarTarefa):
        print("ID da tarefa não encontrado")
        return

    valor = input(
        "O que deseja alterar? (descrição, dia, local, pendente) ")

    if valor == "ID":
        print("Não é possível alterar o ID de uma tarefa")
        return
        
    novoValor = input("Digite o novo valor: ")

    if valor == "dia" and horarioEDiaJaUtilizado(novoValor, alterarTarefa['hora']):
        print("\nEsta data já está sendo utilizada por outra tarefa, tente outro horário ou outro dia!\n")
        return
    elif valor == "hora" and horarioEDiaJaUtilizado(alterarTarefa['dia'], novoValor):
        print("\nEsta data já está sendo utilizada por outra tarefa, tente outro horário ou outro dia!\n")
        return

    # Alterar o valor desejado
    alterarTarefa[valor] = novoValor

    # Imprimindo a tarefa após alteração
    print("\n================Tarefa alterada!================")
    for k, v in alterarTarefa.items():
        print(k+" - {}".format(v))
    print("\n")


def exclueTarefa(sistema, ID):
    # Encontrar a tarefa
    removerTarefa = next(
        (tarefa for tarefa in sistema if tarefa["ID"] == ID), False)

    if (not removerTarefa):
        print("ID da tarefa não encontrado")
        return

    # Removê-la
    sistema.remove(removerTarefa)

    # Imprimindo a tarefa após alteração
    print("\n================Tarefa excluída!================")
    for k, v in removerTarefa.items():
        print(k+" - {}".format(v))
    print("\n")


def imprimeTarefas(sistema):
    for e in sistema:
        for k, v in e.items():
            print(k+"- {}".format(v))
        print("\n")

def adicionarTarefa(descricao, dia, local, hora, sistema):
    novoId = random.randint(1, 10000)

    if horarioEDiaJaUtilizado(dia, hora):
        print("\nEsse horário já está sendo utilizado neste dia, tente outro horário ou outro dia!\n")
        return

    novaTarefa = {'ID': novoId, 'descrição': descricao, 'dia': dia, 'local': local, 'pendente': "sim", 'hora': hora}

    sistema.append(novaTarefa)

    # Imprimindo a tarefa adiconada
    print("\n================Tarefa adicionada!================")
    for k, v in novaTarefa.items():
        print(k+" - {}".format(v))
    print("\n")


sistema = []
tarefa1 = {'ID': 1, 'descrição': 'Academia',
           'dia': 'segunda', 'local': 'Smart Fit', 'pendente': 'sim', 'hora': "14:00"}
tarefa2 = {'ID': 2, 'descrição': 'Correr', 'dia': 'terça',
           'local': 'Litorânea', 'pendente': 'sim', 'hora': "14:00"}
tarefa3 = {'ID': 3, 'descrição': 'Estudar', 'dia': 'quarta',
           'local': 'Faculadade Cest', 'pendente': 'não', 'hora': "14:00"}
tarefa4 = {'ID': 4, 'descrição': 'Jogar Bola', 'dia': 'segunda',
           'local': 'Estádio Castelão', 'pendente': 'não', 'hora': "14:00"}
tarefa5 = {'ID': 5, 'descrição': 'Dentista', 'dia': 'quinta',
           'local': 'Coife Odonto', 'pendente': 'não', 'hora': "14:00"}
tarefa6 = {'ID': 6, 'descrição': 'Consulta médica',
           'dia': 'sexta', 'local': 'São Domingos', 'pendente': 'sim', 'hora': "14:00"}
sistema.append(tarefa1)
sistema.append(tarefa2)
sistema.append(tarefa3)
sistema.append(tarefa4)
sistema.append(tarefa5)
sistema.append(tarefa6)


# definindo as funcoes e variaveis globais do sistema
tarefas = []


def listarTarefas():
    print("Listar todas suas tarefas")
    for tarefa in tarefas:
        print("------------------------------")
        print("Qual seu afazer", tarefas['tarefa'])
        print("horário", tarefa['tarefa'])
        print("------------------------------ \n")


def consultarTarefa(valor):
    for tarefa in tarefas:
        if tarefa['afazer'] == valor:
            print("tarefa existente.")


def cadastrarUmaTarefa():
    tarefa = input("afazer:")
    hora = str(input("horário: "))

    #key : value
    contato = {'Sua tarefa:': tarefa, 'no horário:': hora}

    tarefas.append(contato)


# -----------------------------------------


op = 0
while op != 6:
    op = int(input('''>>> LISTA DE TAREFAS <<<
        1 - Excluir uma TAREFA
        2 - Consultar uma TAREFA
        3 - Listar todas as TAREFAS
        4 - Alterar uma TAREFA
        5 - Adicionar uma TAREFA
        6 - Sair do sistema

        Escolha uma opção: '''))
    if op == 1:
        ID = int(input("digite o ID da tarefa: "))
        exclueTarefa(sistema, ID)

    elif op == 2:
        print("Consultar uma tarefa pelo dia")
        dia = input("Digite qual o dia da semana: ")
        pesquisaDia(sistema, dia)

    elif op == 3:
        imprimeTarefas(sistema)

    elif op == 4:
        idTarefa = int(input("Digite qual o ID da tarefa a ser alterada: "))

        editarTarefa(sistema, idTarefa)
    elif op == 5:
        descricao = input("Digite a descrição da tarefa: ")
        dia = input("Digite o dia da tarefa: ")
        local = input("Digite o local da tarefa: ")
        hora = input("Digite a hora da tarefa no formato HH:mm (ex: 12:30): ")

        adicionarTarefa(descricao, dia, local, hora, sistema)
    elif op == 6:
        print("Saindo do sistema.Volte sempre, se organize!")
    else:
        print("Opção inválida. Tente novamente.")